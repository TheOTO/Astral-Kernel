on post-fs
    write /sys/block/zram0/comp_algorithm lz4
    write /sys/block/zram0/max_comp_streams 3
    write /sys/block/zram0/disksize 335544320
    write /sys/block/zram0/queue/rq_affinity 1
    write /sys/block/zram0/queue/iostats 0
    write /sys/block/zram0/queue/nomerges 2

    write /proc/sys/vm/page-cluster 0

on late-fs
    write /sys/block/mmcblk0/queue/read_ahead_kb 1024

on post-fs
    exec u:r:init:s0 -- /system/bin/mkswap /dev/block/zram0
    exec u:r:init:s0 -- /system/bin/swapon /dev/block/zram0

on property:sys.boot_completed=1
    setprop dalvik.vm.heapminfree 2m
    setprop dalvik.vm.heaptargetutilization 0.75
    setprop dalvik.vm.heapsize 544m
    setprop dalvik.vm.heapgrowthlimit 136m
    setprop dalvik.vm.check-dex-sum false
    setprop dalvik.vm.checkjni false
    setprop dalvik.vm.execution-mode jit

    chown system system /sys/class/devfreq/1c00000.qcom,kgsl-3d0/governor
    chown system system /sys/class/devfreq/1c00000.qcom,kgsl-3d0/max_freq
    chown system system /sys/class/devfreq/1c00000.qcom,kgsl-3d0/min_freq
    chmod 0664 /sys/class/devfreq/1c00000.qcom,kgsl-3d0/governor
    chmod 0664 /sys/class/devfreq/1c00000.qcom,kgsl-3d0/max_freq
    chmod 0664 /sys/class/devfreq/1c00000.qcom,kgsl-3d0/min_freq
    
    write /sys/module/governor_msm_adreno_tz/parameters/adrenoboost 1
    write /sys/module/simple_gpu_algorithm/parameters/simple_gpu_activate 1
    write /sys/module/simple_gpu_algorithm/parameters/simple_laziness 4
    write /sys/module/simple_gpu_algorithm/parameters/simple_ramp_threshold 6000

    # bring both cores online
    write /sys/devices/system/cpu/cpu0/online 1
    write /sys/devices/system/cpu/cpu4/online 1

    # cpufreq settings
    chown system system /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
    chown system system /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq
    chown system system /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
    chmod 0664 /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
    chmod 0664 /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq
    chmod 0664 /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor

    chown system system /sys/devices/system/cpu/cpu4/cpufreq/scaling_max_freq
    chown system system /sys/devices/system/cpu/cpu4/cpufreq/scaling_min_freq
    chown system system /sys/devices/system/cpu/cpu4/cpufreq/scaling_governor
    chmod 0664 /sys/devices/system/cpu/cpu4/cpufreq/scaling_max_freq
    chmod 0664 /sys/devices/system/cpu/cpu4/cpufreq/scaling_min_freq
    chmod 0664 /sys/devices/system/cpu/cpu4/cpufreq/scaling_governor

    write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor ironactive
    write /sys/devices/system/cpu/cpu4/cpufreq/scaling_governor ironactive

    write /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq 200000
    write /sys/devices/system/cpu/cpu1/cpufreq/scaling_min_freq 200000
    write /sys/devices/system/cpu/cpu2/cpufreq/scaling_min_freq 200000
    write /sys/devices/system/cpu/cpu3/cpufreq/scaling_min_freq 200000
    write /sys/devices/system/cpu/cpu4/cpufreq/scaling_min_freq 200000
    write /sys/devices/system/cpu/cpu5/cpufreq/scaling_min_freq 200000
    write /sys/devices/system/cpu/cpu6/cpufreq/scaling_min_freq 200000
    write /sys/devices/system/cpu/cpu7/cpufreq/scaling_min_freq 200000

    write /proc/sys/kernel/sched_rt_period_us 1000000
    write /proc/sys/kernel/sched_rt_runtime_us 800000
    write /proc/sys/kernel/sched_wake_to_idle 0
    write /dev/cpuctl/cpu.rt_period_us 1000000
    write /dev/cpuctl/cpu.rt_runtime_us 800000

    write /sys/module/msm_performance/parameters/touchboost 0
    write /sys/module/cpu_boost/parameters/input_boost_freq "0:345600 1:345600 2:345600 3:345600 4:400000 5:400000 6:400000 7:400000"
    write /sys/module/cpu_boost/parameters/boost_ms 0
    write /sys/module/cpu_boost/parameters/input_boost_ms 150
    write /sys/module/cpu_boost/parameters/sync_threshold 345600
    write /sys/module/cpu_boost/parameters/wakeup_boost Y
    write /sys/module/cpu_boost/parameters/hotplug_boost Y

	# disable aggressive cpu thermal throttling
	write /sys/module/msm_thermal/core_control/enabled 0
	write /sys/module/msm_thermal/parameters/enabled Y

    # high performance audio
    write /sys/module/snd_soc_msm8x16_wcd/parameters/high_perf_mode 1
    write /sys/kernel/sound_control_3/gpl_sound_control_enabled 1
    write /sys/kernel/sound_control_3/gpl_headphone_gain 3 3

    # lmk settings
    write /sys/module/lowmemorykiller/parameters/enable_adaptive_lmk 0
    write /sys/module/lowmemorykiller/parameters/lmk_fast_run 1
    write /sys/module/lowmemorykiller/parameters/cost 32
    write /sys/module/lowmemorykiller/parameters/minfree "14255,19006,23758,33262,38013,47517"

    # vm settings
    write /proc/sys/vm/min_free_kbytes 6511
    write /proc/sys/vm/oom_dump_tasks 0
    write /proc/sys/vm/oom_kill_allocating_task 0
    write /proc/sys/vm/vfs_cache_pressure 75
    write /proc/sys/vm/overcommit_memory 1
    write /proc/sys/vm/overcommit_ratio 50
    write /proc/sys/vm/swappiness 30
    write /sys/kernel/dyn_fsync/Dyn_fsync_active 1

    # backlight dimmer settings
    write /sys/module/mdss_fb/parameters/backlight_dimmer Y
    write /sys/module/mdss_fb/parameters/backlight_max 180

    exec u:r:init:s0 root root -- /init.special_power.sh
    exec u:r:su:s0 root root -- /init.special_power.sh
